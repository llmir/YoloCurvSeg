# YoloCurvSeg - You only label one noisy skeleton for vessel-style curvilinear structure segmentation

This is the official repository for our **Medical Image Analysis** paper "YoloCurvSeg: You only label one noisy skeleton for vessel-style curvilinear structure segmentation". [[Paper](https://www.sciencedirect.com/science/article/abs/pii/S1361841523001974)], [[Arxiv](https://arxiv.org/abs/2212.05566)].

[2023-09-15] The five datasets (with full annotations and noisy skeleton annotations) are totally released (in the **datasets** folder)! Five valuable benchmarks to evaluate weakly (and noisy) supervised segmentation methods.

[Note] The datasets and code will be gradually and continuously released!

## Citation ##

If you find this repository useful, please consider citing YoloCurvSeg paper:

```
@article{lin2023yolocurvseg,
  title={YoloCurvSeg: You only label one noisy skeleton for vessel-style curvilinear structure segmentation},
  author={Lin, Li and Peng, Linkai and He, Huaqing and Cheng, Pujin and Wu, Jiewei and Wong, Kenneth KY and Tang, Xiaoying},
  journal={Medical Image Analysis},
  pages={102937},
  year={2023},
  publisher={Elsevier}
}
```

## Method ##

We propose a novel sparsely annotated segmentation framework for curvilinear structures, named YoloCurvSeg. A very essential component of YoloCurvSeg is image synthesis. Specifically, a background generator delivers image backgrounds that closely match the real distributions through inpainting dilated skeletons. The extracted backgrounds are then combined with randomly emulated curves generated by a Space Colonization Algorithmbased foreground generator and through a multilayer patch-wise contrastive learning synthesizer. In this way, a synthetic dataset with both images and curve segmentation labels is obtained, at the cost of only one or a few noisy skeleton annotations. Finally, a segmenter is trained with the generated dataset and possibly an unlabeled dataset. The proposed YoloCurvSeg is evaluated on four publicly available datasets (OCTA500, CORN, DRIVE and CHASEDB1) and the results show that YoloCurvSeg outperforms state-of-the-art WSL segmentation methods by large margins. With only one noisy skeleton annotation (respectively 0.14%, 0.03%, 1.40%, and 0.65% of the full annotation), YoloCurvSeg achieves more than 97% of the fully-supervised performance on each dataset.

![图片](https://github.com/llmir/YoloCurvSeg/assets/16363216/037e4e54-01fd-4c9a-8bd3-c8df476460ae)

YoloCurvSeg achieves more than 97% of the fully-supervised performance on each of four representative datasets utilizing only one noisy skeleton annotation, which means physicians can save largely save labeling time and still obtain satisfactory segmentation results.

![图片](https://github.com/llmir/YoloCurvSeg/assets/16363216/11ef0ab4-4bc6-4932-b1df-d0738dfb2823)

Top: Overview of our proposed YoloCurvSeg, which comprises four main components: a space colonization algorithm-based curve generator, a background inpainter, a multilayer patch-wise contrastive foreground–background fusion based synthesizer, and a two-stage coarse-to-fine segmenter. Bottom: Details of the Curve Generator and the curve generation process for the four datasets utilized.

![图片](https://github.com/llmir/YoloCurvSeg/assets/16363216/20b7099d-a2b0-4f3f-9b45-051463f116a1)

Visualization of synthetic data from YoloCurvSeg. From left to right are examples of the noisy skeleton label, the inflated inpainting mask, the extracted background, the generated foreground, the synthesized image and the generated foreground superimposed on the synthesized image.

![图片](https://github.com/llmir/YoloCurvSeg/assets/16363216/d38f387d-7c8d-48ee-96c2-d0a456b0e48e)

Performance of YoloCurvSeg (coarse stage) given different labeled samples under one-shot setting.

## Datasets ##

The datasets include OCTA500, CORN, DRIVE, CHASEDB1, and DCA1, as detailed in the **Datasets** folder. We provide comprehensive data partitions, cleaned versions (especially for CORN), and preprocessed files (available in the h5 files). Five valuable benchmarks to evaluate weakly (and noisy) supervised segmentation methods.

## Component 1: Foreground Curve Generator ##

